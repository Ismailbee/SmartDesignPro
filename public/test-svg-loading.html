<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG Loading Test - Wedding Names</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            background: #f9f9f9;
            border-left: 4px solid #007bff;
        }
        .test-section h2 {
            margin-top: 0;
            color: #007bff;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        #console-output {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 10px;
        }
        .log-entry {
            margin: 2px 0;
            padding: 2px 0;
        }
        .log-success { color: #4ec9b0; }
        .log-error { color: #f48771; }
        .log-warn { color: #dcdcaa; }
        .log-info { color: #9cdcfe; }
        #svg-container {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border: 2px solid #ddd;
            min-height: 300px;
        }
        .input-group {
            margin: 10px 0;
        }
        .input-group label {
            display: inline-block;
            width: 100px;
            font-weight: bold;
        }
        .input-group input {
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 200px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ§ª SVG Loading Test - Wedding Names Decorative SVG</h1>
        
        <div class="test-section">
            <h2>Test 1: Fetch SVG File</h2>
            <p>This test attempts to load the external SVG file from <code>/svg/weddingStiker/weddingTwoNames/name01.svg</code></p>
            <button onclick="testFetchSVG()">ðŸ”„ Test Fetch SVG</button>
        </div>

        <div class="test-section">
            <h2>Test 2: Replace Names in SVG</h2>
            <div class="input-group">
                <label>Name 1:</label>
                <input type="text" id="name1" value="Hauwa" placeholder="Enter first name">
            </div>
            <div class="input-group">
                <label>Name 2:</label>
                <input type="text" id="name2" value="Abdullahi" placeholder="Enter second name">
            </div>
            <button onclick="testReplaceNames()">ðŸ”„ Replace Names & Display</button>
        </div>

        <div class="test-section">
            <h2>Test 3: Inject into Template</h2>
            <p>This test simulates injecting the SVG into a template with <code>transform="translate(270, 950) scale(3)"</code></p>
            <button onclick="testInjectIntoTemplate()">ðŸ”„ Test Injection</button>
        </div>

        <div class="test-section">
            <h2>Console Output</h2>
            <div id="console-output"></div>
        </div>

        <div class="test-section">
            <h2>SVG Display</h2>
            <div id="svg-container"></div>
        </div>
    </div>

    <script>
        // Custom console logger
        const consoleOutput = document.getElementById('console-output');
        
        function log(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            const timestamp = new Date().toLocaleTimeString();
            entry.textContent = `[${timestamp}] ${message}`;
            consoleOutput.appendChild(entry);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
            
            // Also log to browser console
            console.log(message);
        }

        function toTitleCase(str) {
            if (!str) return '';
            return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();
        }

        // Test 1: Fetch SVG
        async function testFetchSVG() {
            log('ðŸ”„ Starting SVG fetch test...', 'info');
            const svgPath = '/svg/weddingStiker/weddingTwoNames/name01.svg';
            
            try {
                log(`ðŸ“¡ Fetching from: ${svgPath}`, 'info');
                const response = await fetch(svgPath);
                
                log(`Response status: ${response.status} ${response.statusText}`, response.ok ? 'success' : 'error');
                log(`Response URL: ${response.url}`, 'info');
                
                if (!response.ok) {
                    log('âŒ Fetch failed!', 'error');
                    log('ðŸ’¡ Check if file exists at public/svg/weddingStiker/weddingTwoNames/name01.svg', 'warn');
                    return null;
                }
                
                const svgContent = await response.text();
                log(`âœ… Successfully loaded SVG (${svgContent.length} characters)`, 'success');
                log(`First 150 chars: ${svgContent.substring(0, 150)}...`, 'info');
                
                return svgContent;
            } catch (error) {
                log(`âŒ Error: ${error.message}`, 'error');
                return null;
            }
        }

        // Test 2: Replace Names
        async function testReplaceNames() {
            log('ðŸ”„ Starting name replacement test...', 'info');
            
            const name1 = document.getElementById('name1').value;
            const name2 = document.getElementById('name2').value;
            
            if (!name1 || !name2) {
                log('âŒ Please enter both names', 'error');
                return;
            }
            
            const svgContent = await testFetchSVG();
            if (!svgContent) {
                log('âŒ Cannot proceed - SVG not loaded', 'error');
                return;
            }
            
            const formattedName1 = toTitleCase(name1);
            const formattedName2 = toTitleCase(name2);
            
            log(`ðŸ”„ Replacing: Muhammad â†’ ${formattedName1}, Hauwawu â†’ ${formattedName2}`, 'info');
            
            const modifiedSVG = svgContent
                .replace(/>Muhammad</g, `>${formattedName1}<`)
                .replace(/>Hauwawu</g, `>${formattedName2}<`);
            
            log('âœ… Names replaced successfully', 'success');
            
            // Display the SVG
            const container = document.getElementById('svg-container');
            container.innerHTML = modifiedSVG;
            
            log('âœ… SVG displayed in container', 'success');
        }

        // Test 3: Inject into Template
        async function testInjectIntoTemplate() {
            log('ðŸ”„ Starting template injection test...', 'info');
            
            const name1 = document.getElementById('name1').value || 'Hauwa';
            const name2 = document.getElementById('name2').value || 'Abdullahi';
            
            const svgContent = await testFetchSVG();
            if (!svgContent) {
                log('âŒ Cannot proceed - SVG not loaded', 'error');
                return;
            }
            
            const formattedName1 = toTitleCase(name1);
            const formattedName2 = toTitleCase(name2);
            
            const modifiedSVG = svgContent
                .replace(/>Muhammad</g, `>${formattedName1}<`)
                .replace(/>Hauwawu</g, `>${formattedName2}<`);
            
            // Create a template SVG with wedding-names-group
            const templateSVG = `
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2996.9 1685.75" width="800" height="450">
                    <defs>
                        <!-- Template defs will be populated here -->
                    </defs>
                    <rect width="100%" height="100%" fill="#f0f0f0"/>
                    <text x="1498" y="100" text-anchor="middle" font-size="40" fill="#333">Template SVG (scaled down for display)</text>
                    <g id="wedding-names-group" transform="translate(270, 950) scale(3)">
                        <!-- Names will be injected here -->
                    </g>
                </svg>
            `;
            
            const container = document.getElementById('svg-container');
            container.innerHTML = templateSVG;
            
            const templateSVGElement = container.querySelector('svg');
            const weddingNamesGroup = templateSVGElement.querySelector('#wedding-names-group');
            
            if (!weddingNamesGroup) {
                log('âŒ Could not find #wedding-names-group', 'error');
                return;
            }
            
            log('âœ… Found #wedding-names-group in template', 'success');
            log(`   Transform: ${weddingNamesGroup.getAttribute('transform')}`, 'info');
            
            // Parse the modified SVG
            const parser = new DOMParser();
            const svgDoc = parser.parseFromString(modifiedSVG, 'image/svg+xml');
            
            // Inject defs
            const loadedDefs = svgDoc.querySelector('defs');
            if (loadedDefs) {
                let templateDefs = templateSVGElement.querySelector('defs');
                const defsChildren = Array.from(loadedDefs.childNodes);
                defsChildren.forEach(child => {
                    const importedNode = document.importNode(child, true);
                    templateDefs.appendChild(importedNode);
                });
                log('âœ… Font definition injected into template <defs>', 'success');
            }
            
            // Inject content
            const mainGroup = svgDoc.querySelector('g[id="_2887722386880"]');
            if (!mainGroup) {
                log('âŒ Could not find main group in loaded SVG', 'error');
                return;
            }
            
            // Clear and inject
            while (weddingNamesGroup.firstChild) {
                weddingNamesGroup.removeChild(weddingNamesGroup.firstChild);
            }
            
            const children = Array.from(mainGroup.childNodes);
            children.forEach(child => {
                const importedNode = document.importNode(child, true);
                weddingNamesGroup.appendChild(importedNode);
            });
            
            log(`âœ… Successfully injected ${children.length} elements into template`, 'success');
            log('   Transform maintained: ' + weddingNamesGroup.getAttribute('transform'), 'success');
            log('âœ… Test complete - check SVG display above', 'success');
        }

        // Initial message
        log('ðŸ§ª SVG Loading Test Page Ready', 'success');
        log('Click the buttons above to run tests', 'info');
    </script>
</body>
</html>

